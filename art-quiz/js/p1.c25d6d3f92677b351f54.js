(()=>{const e=document.querySelector(".page1"),t=document.querySelector(".page2"),n=document.querySelector(".page4"),s=document.querySelector(".page3"),a=document.querySelector(".btn1"),r=document.querySelector(".btn2"),c=document.querySelector(".btn4"),i=(document.querySelector(".btn3"),document.querySelector(".close__btn")),d=document.querySelector(".wrapper-cat"),o=document.querySelector(".btn-home"),l=document.querySelector(".btn-homeX");document.querySelector(".play-picture-question-wrapper"),a.addEventListener("click",(function(){e.classList.add("hide"),t.classList.remove("hide"),n.classList.add("hide")})),c.addEventListener("click",(function(){e.classList.add("hide"),n.classList.remove("hide")})),i.addEventListener("click",(function(){e.classList.remove("hide"),n.classList.add("hide")})),r.addEventListener("click",(function(){e.classList.add("hide"),t.classList.remove("hide"),s.classList.remove("hide")})),o.addEventListener("click",(function(){e.classList.remove("hide"),t.classList.add("hide")})),wrapcat=document.querySelector(".wrapper-cat"),l.addEventListener("click",(function(){F(),z(),e.classList.remove("hide"),t.classList.add("hide"),d.classList.add("hide")}));let u=document.getElementById("minus-btn"),m=document.getElementById("count"),h=document.getElementById("plus-btn"),p=0;m.innerHTML=p,u.addEventListener("click",(()=>{p<=0?m.innerHTML=0:p-=1,m.innerHTML=p})),h.addEventListener("click",(()=>{p+=1,m.innerHTML=p}));const L=document.querySelector(".answer__list"),g=document.querySelector(".image__question"),v=document.querySelector(".play__wrapper"),y=document.querySelector(".question"),w=document.querySelector(".picture__answer-list"),f=document.querySelector(".wrapper__image-question"),E=document.querySelector(".btn1"),_=document.querySelector(".btn2"),k=document.querySelector(".cat-author-games"),A=document.querySelector(".cat-main-wrapper"),q=document.querySelector("main");let b;document.querySelector(".start-page-wrapper");const T=[],M=[];let S,H,N=0,$=0,I=!1,j=!1;function x(e){!function(e){const t=new Image;t.src=`https://raw.githubusercontent.com/k3kit/image-data/master/img/${T[e].imageNum}.jpg`,t.onload=()=>{g.style.backgroundImage=`url('${t.src}')`,g.classList.add("scale-out-center")}}(e),1===T[e].randomAnswerArray.length&&T[e].randomAnswer(T),function(e){L.innerHTML="",T[e].randomAnswerArray.forEach(((e,t)=>{let n=document.createElement("div");n.className="answers__list-item",n.innerHTML=`${T[e].author}`,L.append(n),n.classList.add("scale-out-center"),3===t&&(I=!1)})),S=document.querySelectorAll(".answers__list-item"),S.forEach(((e,t)=>{e.addEventListener("click",(()=>{I||(I=!0,O(t),f.classList.remove("hide"))}))}))}(e)}function G(e){1===T[e].randomAnswerArray.length&&T[e].randomAnswer(T),function(e){w.innerHTML="",T[e].randomAnswerArray.forEach(((e,t)=>{let n=document.createElement("div");n.className="author__answers-item",w.append(n);let s=new Image;n.classList.add("scale-out-center"),s.src=`https://raw.githubusercontent.com/k3kit/image-data/master/img/${e}.jpg`,s.onload=()=>{setTimeout((()=>{n.style.backgroundImage=`url('${s.src}')`,n.classList.add("filter"),3===t&&(I=!1),setTimeout((()=>{n.classList.remove("filter")}),600)}),300*t)}})),H=document.querySelectorAll(".author__answers-item"),H.forEach(((e,t)=>{e.addEventListener("click",(()=>{I||(I=!0,O(t),f.classList.add("hide"))}))}))}(e),B(`Какую картину написал ${T[e].author}?`)}function P(e){void 0!==e&&(N=e),$=0;let t=M[N][$];N<12?(x(t),B("Кто написал эту картину?")):(G(t),B(`Какую картину написал ${T[t].author}?`))}function B(e){y.innerHTML=`${e}`}function O(e){if(j)return;j=!0;let t=10*N+$;e===T[t].rightAnswer?(T[t].tempGuessed=!0,X(!0,t)):X(!1,t)}function X(e,t,n=!1){console.log("aaa");let s=document.createElement("div");const a=new Image;a.src=`https://raw.githubusercontent.com/k3kit/image-data/master/img/${T[t].imageNum}.jpg`,s.append(a);const r=document.createElement("div");r.innerHTML=`${T[t].author}`;const c=document.createElement("div");c.innerHTML=`${T[t].name}`;const i=document.createElement("div");i.innerHTML=`${T[t].year}`;const d=document.createElement("div");d.innerHTML="Продолжить",s.append(r),s.append(c),s.append(i),s.append(d),n?(s.className="result__answer",d.className="popup__btn-next win",A.append(s),d.addEventListener("click",(()=>{D(s),q.classList.remove("overflow-full"),q.classList.add("scale-out-center"),j=!1}))):(v.append(s),d.addEventListener("click",(()=>{9===$?(M[N].forEach((e=>T[e].saveProgress())),L.innerHTML="",g.style.backgroundImage="none",w.innerHTML="",function(){let e=document.createElement("div");e.className="result__answer";const t=document.createElement("div");t.className="round-result",t.innerHTML="0 / 10";const n=document.createElement("div");n.innerHTML="Следующий квиз",n.className="popup__btn-next win",n.addEventListener("click",(()=>{N++,D(e),P()}));const s=document.createElement("div");s.innerHTML="Главная страница",s.className="popup__btn-next win",s.addEventListener("click",(()=>{z(),D(e),J(N<=11?"pic":"author"),F()})),e.append(t),11===N||23===N||e.append(n),e.append(s),v.append(e),function(e,t){for(let e=0;e<=C();e++)t.innerHTML=`${e} / 10`}(0,t)}()):N<12?x(M[N][++$]):G(M[N][++$]),D(s),j=!1})),e?(s.className="result__answer win",d.className="popup__btn-next win"):(s.className="result__answer loose",d.className="popup__btn-next loose"))}function z(){M[N].forEach((e=>T[e].resetProgress()))}function C(){return M[N].reduce(((e,t)=>(T[t].guessed?1:0)+e),0)}function D(e){e.classList.add("hidden-answer-popup"),setTimeout((()=>{e.remove()}),500)}function F(){L.innerHTML="",y.innerHTML="",g.classList.add("hide"),g.classList.remove("hide"),w.innerHTML="",f.classList.add("hide"),f.classList.remove("hide"),y.classList.add("hide"),y.classList.remove("hide"),A.style.display="",j=!1}function J(e){k.innerHTML="";let t=function(e){let t=[];N="pic"===e?0:12;for(let e=0;e<12;e++)t.push(C()),N++;return t}(e),n=0;"pic"!==e&&(n=120),t.forEach(((t,s)=>{let a=n,r=document.createElement("div");r.className="cat-author-item";let c=document.createElement("div");if(c.className="number-cat",c.innerHTML=s<9?`0${s+1}`:`${s+1}`,r.append(c),0!==t){r.classList.add("played");let n=document.createElement("div");n.className="score-cat",n.innerHTML=`${t} / 10`,n.addEventListener("click",(t=>{t.stopPropagation(),setTimeout((()=>{!function(e){N=e,k.innerHTML="",M[N].forEach(((e,t)=>{let n=document.createElement("div");n.className="cat-author-item",T[e].guessed&&n.classList.add("guessed");const s=new Image;s.src=`https://raw.githubusercontent.com/k3kit/image-data/master/full/${T[e].imageNum}full.jpg`,s.onload=()=>{n.style.backgroundImage=`url('${s.src}')`},k.append(n),n.addEventListener("click",(()=>{X(!0,e,!0)}))}))}(("pic"===e?0:12)+s),F()}),300)})),r.append(n)}r.addEventListener("click",(()=>{A.classList.add("main-hide"),A.classList.remove("main-visible"),v.classList.add("main-visible"),v.classList.remove("main-hide"),q.classList.add("overflow-full"),d.classList.remove("hide"),A.style.display="none",P(a/10)}));const i=new Image;i.src=`https://raw.githubusercontent.com/k3kit/image-data/master/img/${T[n].imageNum}.jpg`,i.onload=()=>{r.style.backgroundImage=`url('${i.src}')`},k.append(r),n+=10}))}!async function(){const e=await fetch("./data.json");b=await e.json(),await b.forEach((e=>T.push(new K(e,b.length))))}(),function(){for(let e=0,t=-1;e<240;e++)e%10==0&&(t++,M.push([])),M[t].push(e)}(),E.addEventListener("click",(()=>{J("pic"),f.classList.remove("hide"),g.classList.remove("hide")})),_.addEventListener("click",(()=>{J("author"),g.classList.add("hide"),f.classList.add("hide")})),k.addEventListener("click",(function(){A.classList.add("hide")}));class K{constructor(e,t){this.author=e.author,this.imageNum=e.imageNum,this.name=e.name,this.year=e.year,this.rightAnswer=0,this.guessed=!1,this.tempGuessed=!1,this.randomAnswerArray=[+this.imageNum],this.ArrayLength=t}randomAnswer(e){for(;this.randomAnswerArray.length<4;){let t=Math.floor(Math.random()*this.ArrayLength);this.randomAnswerArray.some((n=>e[n].author===e[t].author))?this.randomAnswer(e):this.randomAnswerArray.push(t)}this.randomAnswerArray.sort((()=>Math.random()-.5)),this.rightAnswer=this.randomAnswerArray.indexOf(+this.imageNum)}reset(){this.guessed=!1,this.tempGuessed=!1,this.randomAnswerArray=[+this.imageNum],this.rightAnswer=0}saveProgress(){this.guessed=this.tempGuessed,this.tempGuessed=!1}resetProgress(){this.tempGuessed=!1}}})();