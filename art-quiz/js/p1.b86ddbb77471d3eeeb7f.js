(()=>{const e=document.querySelector(".page1"),t=document.querySelector(".page2"),s=document.querySelector(".page4"),n=document.querySelector(".page3"),a=document.querySelector(".btn1"),r=document.querySelector(".btn2"),c=document.querySelector(".btn4"),i=(document.querySelector(".btn3"),document.querySelector(".close__btn")),d=document.querySelector(".wrapper-cat"),o=document.querySelector(".btn-home"),l=document.querySelector(".btn-homeX"),u=document.querySelector(".btn-default"),m=document.querySelector(".btn-save");document.querySelector(".play-picture-question-wrapper"),a.addEventListener("click",(function(){e.classList.add("hide"),t.classList.remove("hide"),s.classList.add("hide")})),c.addEventListener("click",(function(){e.classList.add("hide"),s.classList.remove("hide")})),i.addEventListener("click",(function(){e.classList.remove("hide"),s.classList.add("hide")})),r.addEventListener("click",(function(){e.classList.add("hide"),t.classList.remove("hide"),n.classList.remove("hide")})),o.addEventListener("click",(function(){e.classList.remove("hide"),t.classList.add("hide")})),u.addEventListener("click",(function(){e.classList.remove("hide"),t.classList.add("hide")})),m.addEventListener("click",(function(){e.classList.remove("hide"),t.classList.add("hide")})),wrapcat=document.querySelector(".wrapper-cat"),l.addEventListener("click",(function(){K(),D(),e.classList.remove("hide"),t.classList.add("hide"),d.classList.add("hide")}));let h=document.getElementById("minus-btn"),p=document.getElementById("count"),L=document.getElementById("plus-btn"),g=0;p.innerHTML=g,h.addEventListener("click",(()=>{g<=0?p.innerHTML=0:g-=1,p.innerHTML=g})),L.addEventListener("click",(()=>{g+=1,p.innerHTML=g}));const v=document.querySelector(".answer__list"),y=document.querySelector(".image__question"),w=document.querySelector(".play__wrapper"),f=document.querySelector(".question"),E=document.querySelector(".picture__answer-list"),_=document.querySelector(".wrapper__image-question"),k=document.querySelector(".btn1"),q=document.querySelector(".btn2"),A=document.querySelector(".cat-author-games"),b=document.querySelector(".cat-main-wrapper"),S=document.querySelector("main");let T;document.querySelector(".start-page-wrapper");const M=[],H=[];let N,$,I=0,j=0,x=!1,G=!1;function P(e){!function(e){const t=new Image;t.src=`https://raw.githubusercontent.com/k3kit/image-data/master/img/${M[e].imageNum}.jpg`,t.onload=()=>{y.style.backgroundImage=`url('${t.src}')`,y.classList.add("scale-out-center")}}(e),1===M[e].randomAnswerArray.length&&M[e].randomAnswer(M),function(e){v.innerHTML="",M[e].randomAnswerArray.forEach(((e,t)=>{let s=document.createElement("div");s.className="answers__list-item",s.innerHTML=`${M[e].author}`,v.append(s),s.classList.add("scale-out-center"),3===t&&(x=!1)})),N=document.querySelectorAll(".answers__list-item"),N.forEach(((e,t)=>{e.addEventListener("click",(()=>{x||(x=!0,z(t),_.classList.remove("hide"))}))}))}(e)}function B(e){1===M[e].randomAnswerArray.length&&M[e].randomAnswer(M),function(e){E.innerHTML="",M[e].randomAnswerArray.forEach(((e,t)=>{let s=document.createElement("div");s.className="author__answers-item",E.append(s);let n=new Image;s.classList.add("scale-out-center"),n.src=`https://raw.githubusercontent.com/k3kit/image-data/master/img/${e}.jpg`,n.onload=()=>{setTimeout((()=>{s.style.backgroundImage=`url('${n.src}')`,s.classList.add("filter"),3===t&&(x=!1),setTimeout((()=>{s.classList.remove("filter")}),600)}),300*t)}})),$=document.querySelectorAll(".author__answers-item"),$.forEach(((e,t)=>{e.addEventListener("click",(()=>{x||(x=!0,z(t),_.classList.add("hide"))}))}))}(e),X(`Какую картину написал ${M[e].author}?`)}function O(e){void 0!==e&&(I=e),j=0;let t=H[I][j];I<12?(P(t),X("Кто написал эту картину?")):(B(t),X(`Какую картину написал ${M[t].author}?`))}function X(e){f.innerHTML=`${e}`}function z(e){if(G)return;G=!0;let t=10*I+j;e===M[t].rightAnswer?(M[t].tempGuessed=!0,C(!0,t),U.src="/assets/win.mp3",U.play()):(C(!1,t),U.src="/assets/lose.mp3",U.play())}function C(e,t,s=!1){console.log("aaa");let n=document.createElement("div");const a=new Image;a.src=`https://raw.githubusercontent.com/k3kit/image-data/master/img/${M[t].imageNum}.jpg`,n.append(a);const r=document.createElement("div");r.innerHTML=`${M[t].author}`;const c=document.createElement("div");c.innerHTML=`${M[t].name}`;const i=document.createElement("div");i.innerHTML=`${M[t].year}`;const d=document.createElement("div");d.innerHTML="Продолжить",n.append(r),n.append(c),n.append(i),n.append(d),s?(n.className="result__answer",d.className="popup__btn-next win",b.append(n),d.addEventListener("click",(()=>{J(n),S.classList.remove("overflow-full"),S.classList.add("scale-out-center"),G=!1}))):(w.append(n),d.addEventListener("click",(()=>{9===j?(H[I].forEach((e=>M[e].saveProgress())),v.innerHTML="",y.style.backgroundImage="none",E.innerHTML="",function(){let e=document.createElement("div");e.className="result__answer";const t=document.createElement("div");t.className="round-result",t.innerHTML="0 / 10",U.src="/assets/res.mp3",U.play();const s=document.createElement("div");s.innerHTML="Следующий квиз",s.className="popup__btn-next win",s.addEventListener("click",(()=>{I++,J(e),O()}));const n=document.createElement("div");n.innerHTML="Главная страница",n.className="popup__btn-next win",n.addEventListener("click",(()=>{D(),J(e),Q(I<=11?"pic":"author"),K()})),e.append(t),11===I||23===I||e.append(s),e.append(n),w.append(e),function(e,t){for(let e=0;e<=F();e++)t.innerHTML=`${e} / 10`}(0,t)}()):I<12?P(H[I][++j]):B(H[I][++j]),J(n),G=!1})),e?(n.className="result__answer win",d.className="popup__btn-next win"):(n.className="result__answer loose",d.className="popup__btn-next loose"))}function D(){H[I].forEach((e=>M[e].resetProgress()))}function F(){return H[I].reduce(((e,t)=>(M[t].guessed?1:0)+e),0)}function J(e){e.classList.add("hidden-answer-popup"),setTimeout((()=>{e.remove()}),500)}function K(){v.innerHTML="",f.innerHTML="",y.classList.add("hide"),y.classList.remove("hide"),E.innerHTML="",_.classList.add("hide"),_.classList.remove("hide"),f.classList.add("hide"),f.classList.remove("hide"),b.style.display="",G=!1}function Q(e){A.innerHTML="";let t=function(e){let t=[];I="pic"===e?0:12;for(let e=0;e<12;e++)t.push(F()),I++;return t}(e),s=0;"pic"!==e&&(s=120),t.forEach(((t,n)=>{let a=s,r=document.createElement("div");r.className="cat-author-item";let c=document.createElement("div");if(c.className="number-cat",c.innerHTML=n<9?`0${n+1}`:`${n+1}`,r.append(c),0!==t){r.classList.add("played");let s=document.createElement("div");s.className="score-cat",s.innerHTML=`${t} / 10`,s.addEventListener("click",(t=>{t.stopPropagation(),setTimeout((()=>{!function(e){I=e,A.innerHTML="",H[I].forEach(((e,t)=>{let s=document.createElement("div");s.className="cat-author-item",M[e].guessed&&s.classList.add("guessed");const n=new Image;n.src=`https://raw.githubusercontent.com/k3kit/image-data/master/full/${M[e].imageNum}full.jpg`,n.onload=()=>{s.style.backgroundImage=`url('${n.src}')`},A.append(s),s.addEventListener("click",(()=>{C(!0,e,!0)}))}))}(("pic"===e?0:12)+n),K()}),300)})),r.append(s)}r.addEventListener("click",(()=>{b.classList.add("main-hide"),b.classList.remove("main-visible"),w.classList.add("main-visible"),w.classList.remove("main-hide"),S.classList.add("overflow-full"),d.classList.remove("hide"),b.style.display="none",O(a/10)}));const i=new Image;i.src=`https://raw.githubusercontent.com/k3kit/image-data/master/img/${M[s].imageNum}.jpg`,i.onload=()=>{r.style.backgroundImage=`url('${i.src}')`},A.append(r),s+=10}))}!async function(){const e=await fetch("./data.json");T=await e.json(),await T.forEach((e=>M.push(new R(e,T.length))))}(),function(){for(let e=0,t=-1;e<240;e++)e%10==0&&(t++,H.push([])),H[t].push(e)}(),k.addEventListener("click",(()=>{Q("pic"),_.classList.remove("hide"),y.classList.remove("hide")})),q.addEventListener("click",(()=>{Q("author"),y.classList.add("hide"),_.classList.add("hide")})),A.addEventListener("click",(function(){b.classList.add("hide")}));class R{constructor(e,t){this.author=e.author,this.imageNum=e.imageNum,this.name=e.name,this.year=e.year,this.rightAnswer=0,this.guessed=!1,this.tempGuessed=!1,this.randomAnswerArray=[+this.imageNum],this.ArrayLength=t}randomAnswer(e){for(;this.randomAnswerArray.length<4;){let t=Math.floor(Math.random()*this.ArrayLength);this.randomAnswerArray.some((s=>e[s].author===e[t].author))?this.randomAnswer(e):this.randomAnswerArray.push(t)}this.randomAnswerArray.sort((()=>Math.random()-.5)),this.rightAnswer=this.randomAnswerArray.indexOf(+this.imageNum)}reset(){this.guessed=!1,this.tempGuessed=!1,this.randomAnswerArray=[+this.imageNum],this.rightAnswer=0}saveProgress(){this.guessed=this.tempGuessed,this.tempGuessed=!1}resetProgress(){this.tempGuessed=!1}}const U=new Audio,V=document.querySelector("#volume");volume.addEventListener("change",(function(){U.volume=V.value/100}))})();